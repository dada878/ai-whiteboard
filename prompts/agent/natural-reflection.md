<!-- 
====================
📍 使用位置 (Used In)
====================
- /app/api/ai-agent/stream-natural/route.ts (reflectNaturally 函數)
  
====================
🎯 功能說明 (Purpose)
====================
- 反思已收集的資訊是否足夠
- 評估圖探索策略的執行情況
- 決定是否需要繼續搜尋

====================
🔧 相關變數 (Variables)
====================
- {{originalQuestion}} - 原始問題
- {{toolCount}} - 已使用的工具數量
- {{collectedInfo}} - 收集到的資訊（JSON）
- {{foundNoteIds}} - 找到的便利貼 ID 列表
- {{detailedNotes}} - 詳細探索的便利貼數量
- {{detailedNotesInfo}} - 詳細便利貼資訊
- {{graphExplorationStatus}} - 圖探索狀況
-->

# 自然反思 Prompt

請用自然的第一人稱思考方式反思：基於下面提供的實際資料，我收集的資訊是否足以回答使用者的問題？

## 重要提醒
⚠️ **請基於下面提供的實際資料進行反思，不要編造範例資料！**

## 🔗 圖探索檢查重點
- 我是否找到了有連接關係的便利貼（connections.total > 0）？
- 我是否對那些便利貼的**相鄰節點**（connections 中的其他 noteId）進行了探索？
- **錯誤檢查**：我是否重複對同一個便利貼使用 get_note_by_id？應該避免！
- **正確做法**：應該對 connections.incoming 和 connections.outgoing 中的 noteId 使用 get_note_by_id
- 相鄰節點可能包含更深入或相關的資訊，是圖探索的核心價值

如果需要繼續搜尋，要同時考慮發散性搜尋和圖探索策略。

## 實際收集到的資訊

**原始問題**：{{originalQuestion}}

**使用的工具數量**：{{toolCount}} 個

**以下是我實際使用工具收集到的完整資料（包含所有工具調用的結果）**：
```json
{{collectedInfo}}
```

這些資料包含了每個工具調用的：
- `tool`: 使用的工具名稱
- `args`: 傳遞給工具的參數
- `result`: 工具返回的結果

## 📊 資訊分析
- 找到的便利貼 ID：{{foundNoteIds}}
- 已詳細探索的便利貼：{{detailedNotes}} 個
  {{detailedNotesInfo}}

## 🔗 圖探索狀況檢查
{{graphExplorationStatus}}

## 思考要點（基於上述實際資料）

1. **根據上面的實際資料，我找到的資訊是否能回答使用者的問題？**
2. **基於實際找到的內容，我對這個答案有多確信？**
3. **🔗 圖探索檢查（檢查上面的實際資料）**：
   - 實際資料中有沒有重複對同一個便利貼使用 get_note_by_id？
   - 實際資料中有沒有對相鄰節點進行探索？
   - 根據上面顯示的連接關係，有沒有值得探索的相鄰節點？
4. **基於現有資料，我是否需要尋找更多資訊？**
5. **如果需要搜尋，應該從哪些角度進行？**

## 🔍 策略提醒
- **發散性搜尋**：嘗試不同關鍵字、同義詞、相關概念
- **正確的圖探索**：對 connections.incoming 和 connections.outgoing 中的**其他便利貼 ID** 使用 get_note_by_id
- **避免錯誤**：不要重複對同一個便利貼使用 get_note_by_id
- **組合策略**：搜尋新關鍵字的同時，探索未探索的相鄰節點

## 回答要求
請用自然的語氣回答，描述你對**上面實際資料**的分析。不要創造新的範例資料，只分析提供給你的實際資料。